<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Probability theory – Statistical Analysis Using R: Online Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dist_bernoulli.html" rel="next">
<link href="./sets.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5e2915e4d4df5928b2b0a61215b328b6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probability.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability theory</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Analysis Using R: Online Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome!</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Set theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Distributions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_bernoulli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Bernoulli distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Binomial distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_chisquared.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Chi-squared distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_exponential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Exponential distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_f.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">F distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_geometric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Geometric distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_negativebinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Negative binomial distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Poisson distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">t distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dist_uniform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Uniform distribution</span></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proofs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Proofs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./listofsymbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">List of Symbols</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#experiments" id="toc-experiments" class="nav-link active" data-scroll-target="#experiments"><span class="header-section-number">3.1</span> Experiments</a></li>
  <li><a href="#the-axioms-of-probability" id="toc-the-axioms-of-probability" class="nav-link" data-scroll-target="#the-axioms-of-probability"><span class="header-section-number">3.2</span> The axioms of probability</a>
  <ul class="collapse">
  <li><a href="#joint-marginal-and-conditional-probability" id="toc-joint-marginal-and-conditional-probability" class="nav-link" data-scroll-target="#joint-marginal-and-conditional-probability"><span class="header-section-number">3.2.1</span> Joint, marginal, and conditional probability</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-prob" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability theory</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>It might surprise you to learn that mathematicians did not complete a formal system for defining probability until Andrey Kolmogorov’s work in the 1930s. Many important insights and results had been noticed by earlier mathematicians, but our “classical” understanding of probability is still less than 100 years old. More recently, mathematicians have explored other systems of probability by relaxing or modifying Kolmogorov’s axioms. The most famous alternative system of probability is the “Bayesian” school, which I will not discuss here.</p>
<section id="experiments" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="experiments"><span class="header-section-number">3.1</span> Experiments</h2>
<p>Kolmogorov’s definition of probability relies on the idea of an experiment. The “experiment” can be very broad or abstract, including actual experiments performed by scientists in laboratories but also natural phenomenon such as tomorrow’s weather and human activities such as a hedge fund’s annual performance.</p>
<p>Imagine an experiment made up of many different trials of the same experimental process. Each trial ends in a single outcome, and there are multiple possible outcomes (possibly an infinite number of outcomes). For example, let us consider an experiment where each trial involves flipping two coins, each marked H for heads and T for tails. Then the four ordered outcomes would be:</p>
<div id="fig-outcomes" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-outcomes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><span class="math display">\[\qquad \, \Large{\{\mathrm{HH},\mathrm{TH},\mathrm{TH},\mathrm{TT}\}}\]</span> <span class="math display">\[{}_\mathrm{First\ flip}{}^\nearrow \quad {}^\nwarrow{}_\mathrm{Second\ flip}\]</span></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outcomes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Outcomes of an experiment which flips two coins
</figcaption>
</figure>
</div>
<p>Each trial ends in one outcome, but we will want to consider combinations of outcomes, which will be called events. For example, the event {HH, HT, TH} includes three outcomes, and we could think of this event as “a trial resulting in at least one head”. One special event is the empty set (seen earlier in <a href="sets.html" class="quarto-xref"><span>Chapter 2</span></a>), sometimes written <span class="math inline">\(\emptyset\)</span>, which is an event containing no outcomes. This event never happens(!) but we still find it mathematically useful, just like we find zero helpful even if we don’t “see” zeroes around us. Set theory teaches us that for <span class="math inline">\(n\)</span> different elements, there are <span class="math inline">\(2^n\)</span> ways to choose combinations of those elements, which means that with four outcomes there are sixteen events:</p>
<div id="fig-events" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-events-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><span class="math display">\[\begin{array}{ll} \scriptsize{\textit{1 event with no outcomes}} &amp; \emptyset \\
\scriptsize{\textit{4 events with one outcome}} &amp; \{\mathrm{HH}\},\{\mathrm{HT}\},\{\mathrm{TH}\},\{\mathrm{TT}\} \\
\scriptsize{\textit{6 events with two outcomes}} &amp; \{\mathrm{HH},\mathrm{HT}\},\{\mathrm{HH},\mathrm{TH}\},\{\mathrm{HH},\mathrm{TT}\},\{\mathrm{HT},\mathrm{TH}\},\{\mathrm{HT},\mathrm{TT}\},\{\mathrm{TH},\mathrm{TT}\} \\
\scriptsize{\textit{4 events with three outcomes}} &amp; \{\mathrm{HH},\mathrm{HT},\mathrm{TH}\},\{\mathrm{HH},\mathrm{HT},\mathrm{TT}\},\{\mathrm{HH},\mathrm{TH},\mathrm{TT}\},\{\mathrm{HT},\mathrm{TH},\mathrm{TT}\} \\
\scriptsize{\textit{1 event with four outcomes}} &amp; \{\mathrm{HH},\mathrm{HT},\mathrm{TH},\mathrm{TT}\} \end{array}\]</span></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-events-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Events of an experiment which flips two coins
</figcaption>
</figure>
</div>
<p>Notice that these combinations are <em>unordered</em> subsets of the outcomes. For example, I did not separately list both {HT, TT} and {TT, HT} as two different events, since they both contain the same two outcomes. On the other hand, the nature of our experiment requires that the order of the <em>flips</em> does matter: the event {HT, TT} is meaningfully different from the event {TH, TT}.</p>
<p>Let’s review:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>outcomes</strong> of an experiment are the set of all possible results from a single trial.</p>
<p>The <strong>event space</strong> of an experiment is the set of all unordered combinations of the outcomes including the empty set (<span class="math inline">\(\emptyset\)</span>), each individual outcome, and all pairs, triplets, etc. of the outcomes.</p>
</div>
</div>
</section>
<section id="the-axioms-of-probability" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="the-axioms-of-probability"><span class="header-section-number">3.2</span> The axioms of probability</h2>
<p>Having set up this idea of an experiment, we now define probability as a way of assigning a numeric score to each event in an experiment.</p>
<p>There are of course many ways we could make numeric scores for each event, and most of them are unhelpful. So we will need rules to help separate “probability” from all the other, unhelpful ways we could assign scores to events. Andrey Kolmogorov proposed the following three rules, often called the axioms of probability. If we assume these rules, all of probability and (classical) parametric statistics will follow:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let the triplet <span class="math inline">\(\Omega,\mathcal{F},P\)</span> define an experiment, where:</p>
<ul>
<li><p><span class="math inline">\(\Omega\)</span> is the set of outcomes of the experiment (possible results of a single trial)</p></li>
<li><p><span class="math inline">\(\mathcal{F}\)</span> is the set of events of the experiment (combinations of outcomes)</p></li>
<li><p><span class="math inline">\(P(E)\)</span> is a function which assigns a real number to each event <span class="math inline">\(E\)</span> in <span class="math inline">\(\mathcal{F}\)</span></p></li>
</ul>
<p>If we choose <span class="math inline">\(P\)</span> using the following three conditions,</p>
<ol type="1">
<li><p><span class="math inline">\(P(E) \geq 0 \quad \forall E \in F\)</span> (All events have non-negative probability)</p></li>
<li><p><span class="math inline">\(P(\Omega)=1\)</span> (The probability of observing any of the outcomes is 1)</p></li>
<li><p>If a group of events <span class="math inline">\(E_1,E_1,\ldots,E_n\)</span> are disjoint then <span class="math inline">\(P(\bigcup_{i=1}^n E_i)=\sum_{i=1}^n P(E_i)\)</span> (The combined probability of a union of mutually exclusive events is equal to the sum of the probabilities of each individual event)</p></li>
</ol>
<p>Then we say that <span class="math inline">\(P\)</span> measures <strong>probability</strong>.</p>
</div>
</div>
<p>Now that we have defined probability, let’s review some basic properties of how probability works. You have probably seen these before, or at least they should make a certain amount of sense. I will not prove them here, but they can all be proven from the axioms and other simple mathematical theorems.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let the triplet <span class="math inline">\(\Omega,\mathcal{F},P\)</span> define an experiment, and let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events within <span class="math inline">\(\mathcal{F}\)</span>:</p>
<ul>
<li><p><span class="math inline">\(P(A^c ) = 1 - P(A)\)</span></p></li>
<li><p><span class="math inline">\(P(A \cup B) = P(A) + P(B) - (A \cap B)\)</span></p></li>
<li><p>If A and B are disjoint (mutually exclusive), then <span class="math inline">\(P(A \cap B) = P(A) + P(B)\)</span></p></li>
</ul>
</div>
</div>
<p>The first result above simply confirms that the probability of an event happening is equivalent to one minus the probability of the event not happening. The second result helps us to find the probability that <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> will happen (you can think of union as ‘or’ operator and intersection as ‘and’). If we simply add all the probability of <span class="math inline">\(A\)</span> to all the probability of <span class="math inline">\(B\)</span>, we will double-count their intersection, which is in both sets. So we must subtract one intersection… unless the two sets are disjoint, in which case there is no problem!</p>
<section id="joint-marginal-and-conditional-probability" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="joint-marginal-and-conditional-probability"><span class="header-section-number">3.2.1</span> Joint, marginal, and conditional probability</h3>
<p>Often we wish to study the relationships between two or more experiments. For example, consider someone who takes a diagnostic test for a particular disease:</p>
<ul>
<li><p>One experiment is whether the person actually has the disease</p></li>
<li><p>A different experiment is whether the person tests positive for the disease, <em>regardless of whether they actually have it</em></p></li>
</ul>
<p>Most people who test for a disease have some valid concern, and so among the test-takers let us assume that <span class="math inline">\(P(\mathrm{Disease})=0.60\)</span>. Let us further assume that the test is imperfect, with few fase positives but lots of false negatives, and so <span class="math inline">\(P(\mathrm{Positive})=0.45\)</span>.</p>
<p>These two pieces of information are not enough for us to understand the full implications of a positive test. A clearer sense of how these two experiments relate to each other could be expressed in a table as follows:</p>
<div id="fig-contingency" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><span class="math display">\[ \begin{array}{rrccc} &amp; &amp; &amp; \textbf{Test Result} &amp; \\ &amp; &amp; \mathrm{Positive} &amp; \mathrm{Negative} &amp; \textit{Total} \\ &amp; \mathrm{Has\ Disease} &amp; 0.44 &amp; 0.16 &amp; \textit{0.60} \\ \textbf{Health} &amp; \mathrm{Does\ Not} &amp; 0.01 &amp; 0.39 &amp; \textit{0.40} \\ &amp; \textit{Total} &amp; \textit{0.45} &amp; \textit{0.55} &amp; \end{array}\]</span></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contingency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Contingency table of joint and marginal probabilities
</figcaption>
</figure>
</div>
<p>The four cells at the top right are <strong>joint probabilities</strong>, which tell you the chance of simultaneously observing two pieces of information. For example, among people who test for this disease, 39% do not have the disease and yet test negative.</p>
<p>The four italicized cells along the bottom and right sides are <strong>marginal probabilities</strong>, which tell you the overall chance of one experiment’s outcome averaged over all possible results from the second experiment. Notice that we can compute these marginal probabilities by totaling the rows and columns of the joint probabilities in the literal <em>margins</em> of the table.</p>
<p>From the combination of the joint and marginal probabilities, we can compute the <strong>conditional probabilities</strong>, which show us how the outcomes of one experiment become more or less likely once we know the result of the other. When we learn about the other experiment, we change the event space of the first experiment, since some joint outcomes are no longer possible. Events containing those outcomes are removed from <span class="math inline">\(\mathcal{F}\)</span>. Probabilities shift such that the total of all remaining events sum to 1.</p>
<p>If we test positive, what is the probability we have the disease? We can disregard the second column above: we now “live” in the first column, totaling 45% (those who test positive). For every 45 people who test positive, 44 test positive and have the disease, while 1 tests positive and does not have the disease. Therefore, the probability of having the disease given a positive test is <span class="math inline">\(0.44/0.45 \approx 0.978.\)</span> We can formalize this result:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let the triplet <span class="math inline">\(\Omega,\mathcal{F},P\)</span> define an experiment, and let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events within <span class="math inline">\(\mathcal{F}\)</span>. The conditional probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span> is written <span class="math inline">\(P(A|B)\)</span> and defined, <span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
</div>
</div>
<p>We can derive three useful rules from this definition of conditional probability. The first flows simply from the above formula if we multiply both sides by <span class="math inline">\(P(B)\)</span>:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let the triplet <span class="math inline">\(\Omega,\mathcal{F},P\)</span> define an experiment, and let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be events within <span class="math inline">\(\mathcal{F}\)</span>. Then, <span class="math display">\[P(A \cap B) = P(A|B) \cdot P(B)\]</span></p>
</div>
</div>
<p>This result allows us to compute the probability of a series of events by multiplying the branching probabilities of each conditional link. Consider an unfair coin which lands heads (“H”) 40% of the time and tails (“T”) 60% of the time. What is the probability of the sequence THH?</p>
<div id="fig-chain" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">---
config:
  look: handDrawn
  theme: neutral
---
flowchart LR
  A((Begin)) -- 0.4 --&gt; B[H _ _]
  A -- 0.6 --&gt; C[T _ _]
  C -- 0.4 --&gt; D[T H _]
  C -- 0.6 --&gt; E[T T _]
  D -- 0.4 --&gt; F[T H H]
  D -- 0.6 --&gt; G[T H T]
  classDef stop stroke:red,color:red
  class B,E,G stop
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chain-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Chain of coin flip probabilities
</figcaption>
</figure>
</div>
<p>Using the rule above, we can see that the probability of the full sequence could be expressed as P(THH)=P(T)∙P(TH|T)∙P(THT|TH)=0.6∙0.4∙0.6=0.144. The second useful result is known as The Law of Complete Probability, and allows us to compute the probability of an event by aggregating its conditional probability among a group of exhaustive and mutually exclusive conditions, meaning that exactly one of the conditions is always true. Let the triplet Ω,F,P define an experiment, and let A be an event within F. Let B_1,B_2,…,B_n also be events within F such that all events B_i are mutually exclusive and ∑_i▒P(B_i ) =1 Then, P(A)=∑_i▒〖P(A|B_i )∙P(B_i ) 〗 As an example, consider the proportion of time that my heart rate is elevated above 80 beats per minute. Elevated heart rates are rare in my sleep, perhaps occurring only during stressful dreams (perhaps 2% of my sleep?). When I’m awake, 80bpm is near my resting heart rate, and so I might spend 25% of my waking hours at rates above that. If I sleep on average 7 hours a day, then we can calculate P(elevated)=P(elevated|asleep)∙P(asleep)+P(elevated|awake)∙P(awake) =0.02∙(7/24)+0.25∙(17/24) ≈18.3% The last useful result I will mention here is a way to calculate P(B|A) from P(A|B). This formula is known as Bayes Theorem, after the English clergyman Reverend Thomas Bayes. Bayes was not a trained mathematician, but his natural curiosity and diligent amateur study led him to this significant result, published posthumously: Let the triplet Ω,F,P define an experiment, and let A and B be events within F. Then, P(B|A)=(P(A|B)∙P(B))/P(A) If we further assume that instead of one event B we have many events B_1,B_2,…,B_n such that all events B_i are mutually exclusive and ∑_i▒P(B_i ) =1, then further, P(B_j |A)=(P(A|B_j )∙P(B_j ))/(∑_i▒〖P(A|B_i )∙P(B_i ) 〗) The second equation above flows from the first equation when we apply our prior result of the Law of Complete Probability. For an example of the first equation at work, consider the heart rate hypothetical above: P(awake|elevated)=(P(elevated|awake)∙P(awake))/P(elevated) =(0.25∙(17/24))/(0.1829…)≈0.968 Notice the distinction: The probability that my heart rate is elevated given that I’m awake is pretty low: only 25% (I don’t exercise as often as I should). But the probability that I’m awake given that my heart rate is elevated is very high: almost 97%. This is both because my heart rarely races in my sleep, and because I’m more often awake than asleep. Bayes Theorem has lent its name to an alternative system of probability known as Bayesian probability, because they both allow the user to update their prior beliefs as more and more data are observed. This broader Bayesian system relaxes some of Kolmogorov’s axioms and creates entirely new models and computations which some “classical” or “frequentist” statisticians find controversial. However, using Bayes Theorem itself is uncontroversial and perfectly valid under Kolmogorov’s axioms.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sets.html" class="pagination-link" aria-label="Set theory">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Set theory</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dist_bernoulli.html" class="pagination-link" aria-label="Bernoulli distribution">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Bernoulli distribution</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>